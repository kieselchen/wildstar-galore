<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="lore-entries">
  <template>
    <style>
        :host {display: block;}
        article {
            margin: 10px;
        }

        .item {
            background: rgba(0, 0, 0, .7);
            border: 1px solid #3e3e47;
            margin-bottom: 20px;
            border-radius: 5px;
            font-family: 'Open Sans';
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
            font-size: 14px;
            font-weight: 300;
            letter-spacing: 3px;
        }

        .item paper-item {
            color: #a19ba6;
            font-weight: 300;
            letter-spacing: 2px;
            line-height: 16px;
            text-decoration: none;
            cursor: pointer;
            padding: 0;
            min-height: 0;
        }

        .item paper-item:hover {
            color: #aae8fd;
            background: #000000;
        }

        .item paper-item:focus {
            color: #aae8fd;
            background: #000000;
        }


        .item paper-item span {
            width: 32px;
            height: 24px;
            padding: 3px;
            text-align: center;
        }

        .item div{
            border: 1px solid #3e3e47;
            padding: 10px;
            color: #C0BDD7;
        }

        .item footer {
            background: #000000;
            color: #a19ba6;
            font-size: 10px;
            text-align: right;
        }

        .item footer a {
            color: #a19ba6;
            text-decoration: none;
        }

        .item footer a:hover {
            color: #aae8fd;
            text-decoration: none;
        }
    </style>

    <!--<iron-ajax id="jsonFile" auto handle-as="json" last-response="{{data}}" on-response="handleResponse"></iron-ajax>-->
    <iron-ajax id="jsonFile" auto handle-as="json" last-response="{{data}}" on-response="handleResponse"></iron-ajax>

    <!--<iron-list items="[[items]]" as="item" scroll-target="html">-->
      <!--<template>-->
        <!--<article>-->
          <!--<div class="item">-->
            <!--<paper-item center-justified>-->
              <!--<span>-->
                <!--<img src="../../images/icons/icon-{{item.sourcetype}}.png"-->
                           <!--alt="{{item.sourcetype}}"-->
                           <!--width="32px"-->
                           <!--height="32px">-->
              <!--</span>-->
              <!--{{item.headline}}-->
            <!--</paper-item>-->
            <!--<div inner-h-t-m-l="{{item.content}}"></div>-->
            <!--<footer><a href="{{item.source}}" target="_blank"># Source</a></footer>-->
          <!--</div>-->
        <!--</article>-->
      <!--</template>-->
    <!--</iron-list>-->


    <template is="dom-repeat" items="{{items}}">
      <article>
        <div class="item">
          <paper-item center-justified onclick="toggle(this)" id="#item{{jsonfile}}{{index}}">
              <span>
                <img src="images/icons/icon-{{item.sourcetype}}.png"
                     alt="{{item.sourcetype}}"
                     width="24px"
                     height="24px">
              </span>
            {{item.headline}}
          </paper-item>
          <iron-collapse id="item{{jsonfile}}{{index}}" tabindex="{{index}}">
            <div id="articlecontent" inner-h-t-m-l="{{item.content}}"></div>
            <footer><a href="{{item.source}}" target="_blank"># Source</a></footer>
          </iron-collapse>
        </div>
      </article>
    </template>
  </template>

  <script>
    (function() {
      'use strict';
      Polymer({
        is: 'lore-entries',
        properties: {
          jsonfile: String,
          selector: String,
          items: {
            type: Array,
            reflectToAttribute: true,
            notify: true
          }
        },
        ready: function() {
          this.$.jsonFile.url = 'data/lore-' + this.jsonfile + '.json';
          this.$.jsonFile.generateRequest();
        },
        handleResponse: function(request) {
          this.items = request.detail.response;
        }
      });
    })();

    function toggle(e) {
      document.querySelector(e.id).toggle();
    }
  </script>
</dom-module>