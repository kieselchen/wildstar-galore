<dom-module id="side-bar">
    <template>
        <style>
            :host {
                display: block;
            }

            paper-menu {
                margin-top: 20px;
                margin-left: 20px;
                position: absolute;
                width: 155px;
                padding: 9px 18px;
                border: 1px solid #3e3e47;
                border-radius: 5px;
                background: #000;
            }

            a {
                color: #a19ba6;
                font-size: 14px;
                font-weight: 300;
                letter-spacing: 2px;
                line-height: 24px;
                text-decoration: none;
                text-transform: uppercase;
                display: block;
            }

            a:hover {
                color: #aae8fd;
            }

            a:active {
                color: #ffffff;
            }

            a.subcategory {
                padding: 5px 0 5px 5px;
                border-bottom: 1px dotted #a19ba6;
                border-left: 1px dotted #a19ba6;
            }

            paper-item {
                min-height: 30px;
                margin-top: 10px;
                padding: 0;
            }

            paper-item:first-child {
                margin-top: 0;
            }
        </style>

        <iron-ajax url=".{{baseUrl}}/data/categories.json" last-response="{{categories}}" auto></iron-ajax>
        <iron-ajax url=".{{baseUrl}}/data/subcategories.json" last-response="{{subcategories}}" auto></iron-ajax>

        <paper-menu class="list" attr-for-selected="data-route" selected="[[route]]">
            <a data-route="home" href=".{{baseUrl}}">Home</a>
            <template is="dom-repeat" items="{{categories}}" as="category">
                <paper-item center-justified onclick="toggle(this)" id="#navi{{category.identifier}}">
                    <a data-route="{{category.identifier}}" href="./{{baseUrl}}{{category.identifier}}">{{category.label}}</a>
                </paper-item>
                <iron-collapse id="navi{{category.identifier}}" tabindex="{{index}}">
                    <template is="dom-repeat" items="{{subcategories}}" as="subcategory">
                        <template is="dom-if" if="[[isSameCategory(category.id, subcategory.cid)]]">
                            <a class="subcategory" data-route="{{subcategory.identifier}}" href="./{{baseUrl}}{{subcategory.identifier}}">â–º {{subcategory.label}}</a>
                        </template>
                    </template>
                </iron-collapse>
            </template>
        </paper-menu>
    </template>

    <script>
        (function() {
            'use strict';

            Polymer({
                is: 'side-bar',
                properties: {
                    items: {
                        type: Array,
                        notify: true,
                    }
                },
                isSameCategory: function (id, cid) {
                    return id === cid;
                }
            });
        })();

        function toggle(e) {
            document.querySelector(e.id).toggle();
        }
    </script>
</dom-module>